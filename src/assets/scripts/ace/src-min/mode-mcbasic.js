const MC_KEYWORDS = 'abpoint|abs|absen|absenable|absolute|acam|acc|accelcmd|accelcmd|accelcmdcart|acceleration|accelerationcommand|accelerationdesyncrot|accelerationdesynctran|accelerationerror|accelerationfactor|accelerationfeedback|accelerationmax|accelerationmaxrot|accelerationmaxrot|accelerationmaxrot|accelerationmaxtran|accelerationmaxtrans|accelerationrate|accelerationrot|accelerationsyncrot|accelerationsynctran|accelerationtrans|accelfbk|accelrationcommand|acmd|acos|activecam|addbreakpoint|additivetorquedelay|ae|afac|afbk|alternativecam|alternativecam.name|alternativeoffset|amax|amrot|amtran|angle|arate|arch|archno|arcpoint|armcmd|armfbk|arot|asc|ascale|ascendingpoint|asin|asin|atran|attach|attach|attachedto|attachto|attachto$|axis|axislist|axisname|axnm|backtrace|backtrace$|backtrace$()|base|base|base.xmax|base.xmin|base.ymax|base.ymin|base.zmax|base.zmin|baudrate|bfprev|blendingfactor|blendingfactorprevious|blendingmethod|blendingpercentage|blendingstartcondition|blendprotected|blist|breakpointlist|bus.baudrate|bus.cycletime|bus.name|bus.numberaxes|bus.phase|bus.power|bus.scan|bus[].naxes|busnumber|byval|call|camcycle|camid|camindex|camlist|camoffset|camtype|camvalue|cappol|cappos|capsrc|capture|captureinput|capturepolarity|captureposition|capturesource|castjoint|castlocation|castpoint|cbpoint|ccdat|ccmd|ccmon|ccomp|ccyc|center|cext|cfb|checkcammonotonic|cind|circle|circlecenter|circleplane|circlepoint|circletype|clearbreakpoint|close|coff|compactive|compensationsource|compensationsource.name|compid|comppcmd|comppfb|comppositioncommand|comppositioncommand|comppositionfeedback|compset|continuetask|continuetask$|coulombfriction|countcommand|countexternal|countextmax|countextmin|countextrollover|countfeedback|countmax|countmin|countrollover|counttorqueadditivecommand|counttorquecommand|counttorquedrivecommand|counttorquefeedback|coupled|cp|cpdat|cplg|cpprev|createcamdata|createcomp|createplsdata|csour.name|ctaddcmd|ctas|ctas$|ctas$|ctcmd|ctdcmd|ctfb|ctime|ctr|ctype|cumulativeposition|currentabsolute|currentpass|currenttime|cval|cyc|cycle|dadd|dampingfactor|databits|dcam|dcon|dec|deceleration|decelerationmax|decelerationrate|decelerationrot|decelerationstop|decelerationstoprot|decelerationstoptrans|decelerationtrans|decstop|decstoprot|decstoptran|delay|delete|delete$|deletecam|deletegroup|deletemovingframe|deletepls|deletesem|deletevar|delg|den|descendingpoint|dest|dest joint|destcenter|destcirclepoint|detach|detachfrom|detachfrom$|dir|dir$|direction|direction|directionexternal|dirext|disabletimeout|disp|displacement|distr|dmax|dmode|dnvram|dnvramsize|dnvramsize|dnvramsize|dominancemode|don|dopass|doublemode|doublemodepercentage|downmaster|downstream|dpls|drate|driveaddress|drivecontrol|driveenable|driveon|driveopmode|drivestatus|drot|dsem|dstat|dtimeout|dtran|dynamicmodel|dynamicparameter|ecmd|efbk|elbowcmd|elbowfbk|elementid|elementname|elementname|elementsize|elementstatus|en|enable|encryptfile|entrystationtype|error|error|errorhistory|errorhistoryclear|errorhistorydelta|errornum|errornumber|errornumber|estokencount|estype|eventdelete|eventlist|eventoff|eventon|exp|fastdataenable|fcam|fcam.name|fden|feedback|filechecksum|filesize|filesize$|filterfactor|firstcam|firstcam.name|fmode|followingmode|gap|gbase|gearinertia|gearratio|gearvalue|getaxis$|getentrypriority|getep|getgroup$|ghere|globalbase|globalhere|globalsetpoint|gohome|goto|gotolimit|grat|grinertia|groupaxis|grouplist|grvalue|gsetpoint|hacc|haltrestart|hdir|hdis|hdismax|here|here|hoff|hold|holdtype|home|homeacceleration|homedirection|homedistance|homedistancemax|homeoffset|homepolarity|homereturn|homestatus|homevelocity|hpol|hret|hstat|htype|hvel|hwassistance|hwassistance|hwiotime|icmd|identificationcancel|identificationfinish|identificationstart|identificationstatus|idletask|idletask$|idnstate|idnstring|idnvalue|idnvaluearray|idnvaluearraydouble|idnvaluedouble|ifac|ifbk|iiw|imfs|imon|import|import_c|in1|in1mode|in2|in2mode|in3|in3mode|inertiareduction|inertiathreshold|info|inpb|input$|inpw|int|interpolationtype|inuse|ireduction|isinwindow|ismonotonic|ismoving|ismovingframesynchronized|isopen|isswaped|istat|istr|itas|itas$|ithreshold|itype|ival|ivala|ivalad|ivald|japerc|jdperc|jerk|jerkaccelerationpercentage|jerkdecelerationpercentage|jerkdesyncrot|jerkdesynctran|jerkfactor|jerkmax|jerkmaxrot|jerkmaxrot|jerkmaxtran|jerkmaxtrans|jerkrate|jerkrot|jerksyncrot|jerksynctran|jerktrans|jfac|jmax|jmrot|jmtran|jog|jointenable|jrate|jrot|jtran|jump|jump3|jump3cp|killtask|killtask$|ktas|ktas$|lcdat|lcompdata|limitswitchthreshold|link|limz|lnvram|lnvramsize|load|load$|loadcamdata|loadcompdata|loadcompdata$|loadglobal|loadglobal$|logger|machinetable|machinetable.xmax|machinetable.xmin|machinetable.ymax|machinetable.zmax|machinetable.zmin|mainfilename|masterdata|masterframe|masterframename|mastersource|mastersource|mastersource.name|mastersync|maxflops|maxoffset|maxposition|mdat|minposition|modelenable|modeloffset|moffset|motion|motionbusvelocitybase|motionbusvelocityscale|motionstatus|move|moves|moveskd|movingframeid|movingframename|movingframescale|msg|msour|msour.master|msyn|multiplier|ndof|next|next.name|nextitem|noi|noi|noofcoordinates|note|num|numberdegreesoffreadom|numberofitems|numberofitems|numberofloops|nvramformat|objectloc|ocomplement|oe|oesettle|ofollow|oload|oload$|onerror|onevent|onsystemerror|open|open file|opensocket|opmode|opmodemap|orientationcomplement|orientationerror|orientationerrorsettle|orientationfollowing|orientationtransformation|ounload|ounload$|outb|outw|parity|pasp|pass|passbackward|passbufferlevel|passbufferlow|passbuffermax|passbuffermin|passbuffersize|passinterpolation|passmethod|passrotmingap|passsymmetricpath|passthroughmaxdeviation|passupto|passwordprotected|pause|pausetask|pausetask$|paxnm|paxnm|payloadinertia|payloadmass|pcb|pcmd|pcmdh|pe|pedel|peekb|peekw|pemax|pen|persistent|pesettle|pext|pextfac|pfac|pfb|pfinal|phase|phys|ping|pipemode|plcmotionstatus|plcmotionstatuscreate|plcmotionstatusdestroy|plcmotionstatusquery|plsaxisname|plsdelaytime|plsementname|plsenable|plshysteresis|plslist|plsoutput|plspolarity|plsposition|plspropagationdelay|plspropagationdisabledelay|plspropagationenabledelay|plsrelatedo|plsrepeat|plssource|pmax|pmaxen|pmin|pminen|pmode|pokeb|pokew|poly|positionbacklash|positionbacklashalpha|positioncommand|positioncommandhistory|positionerror|positionerrordelay|positionerrormax|positionerrorsettle|positionexternal|positionexternalfactor|positionextrollover|positionextrollovermin|positionfactor|positionfeedback|positionfinal|positionmax|positionmaxenable|positionmin|positionminenable|positionrollover|positionrolloverenable|positionrollovermin|positiontogo|pout|ppas|ppas$|ppol|ppos|precomputationmode|prep|prev|prev.name|previous|previous.name|prftype|print|printpoint|printpointusing|printu|printu$|printusing|printusing$|printusingtobuff|printutobuff|priority|procedurechangebit|proceed|proceedtype|profilertype|programcontext|programline|programname|programpassword|programpassword$|prolen|prollover|prollovermin|prompt|ptas|ptas$|ptogo|realtimecontrolbit|realtimestatusbit|recdata|record|record$|recordclose|recording|recordoff|recordon|redirectstdout|redirectstdout$|rescuemode|rese|reset|resetentrystation|retrieve|rmax|rmin|rmode|robottype|robottype$|round|rtcb1|rtcb1 mode|rtcb2|rtcb2 mode|rtcb[ ]|rtkactive|rtsb1 mode|rtsb2 mode|rtsb[ ]|runningtime|save|saxes|scdat|scompdata|scompdata$|scope|sdat|seek|selectaxes|semaphoregive|semaphorestate|semaphoretake|semgive|semstate|semtake|send|senddata|senddata$|ser.brat|ser.ctim|ser.naxes|ser.phase|ser.power|ser.scan|sercos.baudrate|sercos.cycletime|sercos.numberaxes|sercos.phase|sercos.power|sercos.scan|serviceprintlevel|setentrypriority|setep|setpoint|sgn|shl|shr|simulated|sin|sinewave|sinewavefreq|singularitymargin|size|slave|slavedata|slavedeviation|slavedisable|slavedisconnect|slavelag|slavemaxdeviation|slaveorientation|sleep|smooth|smoothfactor|sourcedata|sqrt|stacksize|start|starttask|starttask$|starttype|stas|stas$|stasc|stasc$|state|state|status|status|stepin|stepin$|stepout|stepout$|stepover|stepover$|stop|stopbit|stopphase|stoptaskcycle|stoptaskcycle$|stoptype|storecamdata|storecompdata|storecompdata$|storque|stretchfactor|stretchvector|structure type definition|sumtorque|swapcams axis|syncall|syncclear|syncstart|sys.aload|sys.arate|sys.clock|sys.cputype|sys.date|sys.din|sys.dipswitch|sys.diskfreespace|sys.doubleformat|sys.dout|sys.drate|sys.en|sys.error|sys.errorhandlermode|sys.errornumber|sys.errorprintlevel|sys.flashdisksize|sys.hdoub|sys.hint|sys.information|sys.ipaddressmask|sys.jrate|sys.led|sys.maxmemblock|sys.mcdoub|sys.mcint|sys.motion|sys.motionassistance|sys.motionmargin|sys.name|sys.naxes|sys.pload|sys.pmode|sys.printmode|sys.ramdrivefreespace|sys.ramsize|sys.serconversion|sys.serialnumber|sys.serviceprintlevel|sys.time|sys.vin|sys.vord|sys.vout|sys.vrate|sys.watchdogtest|system.accelerationrate|system.aload|system.averageload|system.clock|system.cputype|system.date|system.decelerationrate|system.din|system.dipswitch|system.diskfreespace|system.doubleformat|system.dout|system.en|system.enable|system.error|system.errorhandlermode|system.errornumber|system.errorprintlevel|system.flashdisksize|system.hdoub|system.hint|system.hostdouble|system.hostinteger|system.information|system.ipaddressmask|system.ipaddressmask|system.jerkrate|system.led|system.led|system.maxmemblock|system.mcdouble|system.mcint|system.mcinteger|system.motion|system.motionassistance|system.motionmargin|system.name|system.naxes|system.numberaxes|system.peakload|system.pipemode|system.pload|system.printmode|system.ramdrivefreespace|system.ramsize|system.serconversion|system.serialnumber|system.serviceprintlevel|system.time|system.velocityoverride|system.velocityrate|system.vin|system.vord|system.vout|system.watchdogtest|systemaxis|systemgroup|tacc|taccmin|taddcmd|tan|targetdata|targetpoint|taskerrornumber|taskid|tasklist|taskstate|tcmd|tcratio|tcratiomax|tdcmd|tdec|tdecmin|te|teen|tef|temax|tfac|tfb|tgcmd|tgfbk|thetaoffset|through|throw|time|timeacceleration|timeaccmin|timedate|timedeceleration|timedecmin|timejog|timeofshortmotions|timesettle|timesettlemax|timesettlemax|tjog|tlimvmax|tmax|tocart|tojoint|tool|tool|tool.xmax|tool.xmin|tool.ymax|tool.ymin|tool.zmax|tool.zmin|torque|torqueaddcommand|torquechangeratio|torquechangeratiomax|torquedrivecommand|torqueerror|torqueerrordisabletype|torqueerrordisabletype|torqueerrorenable|torqueerrorfilter|torqueerrormax|torqueerrorstoptype|torqueerrorstoptype|torquefactor|torquefeedback|torquegearcommand|torquegearfeedabck|torquelimit|torquelimitvelocitymax|torquemax|torquethreshold|torquethreshold|totaltime|translationtransformation|trigger|tsettle|tsettlemax|tshort|ttime|type|unbreakable|unbreakable|unconfiggroup|unload|unload$|upar|upmaster|upstream|upto|userfmode|userfollowingmode|userparameter|userparametervector|vaddcmd|varlist|varlist$|vcmd|vcmdcart|vcruise|ve|velocityadditivecommand|velocitycommand|velocitycommandcartesian|velocitycruise|velocitydesyncrot|velocitydesynctran|velocityerror|velocityexternal|velocityexternalfactor|velocityfactor|velocityfeedback|velocityfeedbackcartesian|velocityfinal|velocityfinalrot|velocityfinaltrans|velocityjog|velocitylimittorquemax|velocitymax|velocitymaxrot|velocitymaxrot|velocitymaxtrans|velocitymaxtrans|velocityoverride|velocityoverspeed|velocityrate|velocityrot|velocitysafetylimit|velocitysyncrot|velocitysynctran|velocitytrans|velocitytransfeedbackvalue|velocitytransvalue|ver|version|vesexecute|vesmessage|vext|vextfac|vfac|vfb|vfbcart|vfinal|vfrot|vftran|viscousfriction|vjog|vlimtmax|vmax|vmrot|vmtran|vord|vospd|vrate|vrot|vscale|vtfbk|vtran|waitformotion|watch|wcmd|wdcycle|wddelete|wdinit|wfbk|wistr|with|withglobal|withpls|wival|wivala|wivalad|wivald|workpiece|workpiece.xmax|workpiece.xmin|workpiece.ymax|workpiece.ymin|workpiece.zmax|workpiece.zmin|wrap|wristcmd|wristfbk|writeidnstring|writeidnvalue|writeidnvaluearray|writeidnvaluearraydouble|writeidnvaluedouble|xmax|xmin|ymax|ymin|zero|zmax|zmin';

const LIB_FUNCS = 'GRP_CLOSE_GRIPPER|GRP_OPEN_GRIPPER|GRP_SET_ACTIVE_GRIPPER|PAY_SET_PAYLOAD|PLT_MOVE_TO_ENTRY_POSITION|PLT_PICK_FROM_PALLET|PLT_PLACE_ON_PALLET|PLT_SET_INDEX_STATUS|PLT_GET_INDEX_STATUS|PLT_GET_STATUS|POWER_ON|POWER_OFF';

const MC_CONSTANTS = 'ON|OFF|MaxDouble|Maxlong|MinLong|Immediate|Immed|SuperImmediate|Simm|Abort|Settled|InPosition|Inpos|GeneratorCompleted|Gcom|Sync|OnPath|EndMotion|Emot|Continue|Cont|NextMotion|Nmot|ClearMotion|Cmot|True|False|PI|Gear|Cam|External|Rise|Fall|Halt|Restart|In1|In2|In3|Homing|Capturing|Positive|Negative|Task_Running|Task_Stopped|Task_Error|Task_Ready|Task_KillStart|Task_Killed|Task_Interrupted|Task_Locked|LEFTY|RIGHTY|BELOW|ABOVE|FLIP|NOFLIP';

const STR_CMDS = 'BIN$|CHR$|HEX$|LCASE$|LEFT$|LEN|LTRIM$|MID$|RIGHT$|RTRIM$|SIZE|SPACE$|STR$|STRD$|STRING$|STRL$|TOASCII8$|TOUTF8$|TYPEOF|UCASE$|UTF$|UTFSTRING$|VAL';

const OTHER_CMDS = 'ABS|ACCEPT|ACOS|ARRAYSIZE|ATAN2|ATN|CONNECT|DISTL|TELL';

define('ace/mode/mcbasic_highlight_rules',(e, t, n) => {
  'use strict';
  const r = e('../lib/oop');
  const i = e('./text_highlight_rules').TextHighlightRules;
  const s = function() {
    const e = this.createKeywordMapper({
      'keyword.control.asp':  MC_KEYWORDS + '|as|group|common|shared|try|catch|long|double|string|sys|location|generic|joint|din|dout|Program|TargetPoint|If|Then|Else|ElseIf|End|terminate|While|Wend|For|To|Each|Case|Select|Return|Continue|Do|Until|Loop|Next|With|Exit|Function|Property|Type|Enum|Sub|IIf',
      'lib.funcs': LIB_FUNCS,
      'storage.type.asp': 'Dim|Call|Class|Const|Dim|Redim|Set|Let|Get|New|Randomize|Option|Explicit',
      'storage.modifier.asp': 'Private|Public|Default',
      'keyword.operator.asp': 'Mod|And|Not|Or|Xor',
      'constant.language.asp': 'Empty|False|Nothing|Null|True|' + MC_CONSTANTS,
      'support.class.asp': 'Application|ObjectContext|Request|Response|Server|Session',
      'support.class.collection.asp': 'Contents|StaticObjects|ClientCertificate|Cookies|Form|QueryString|ServerVariables',
      'support.function.asp': 'Lock|Unlock|SetAbort|SetComplete|BinaryRead|AddHeader|AppendToLog|BinaryWrite|Clear|Flush|Redirect|Write|CreateObject|HTMLEncode|MapPath|URLEncode|Abandon|Convert|Regex',
      'support.function.event.asp': 'Application_OnEnd|Application_OnStart|OnTransactionAbort|OnTransactionCommit|Session_OnEnd|Session_OnStart',
      'support.function.vb.asp': STR_CMDS + '|' + OTHER_CMDS + '|Array|Add|Asc|Atn|CBool|CByte|CCur|CDate|CDbl|CInt|CLng|Conversions|Cos|CreateObject|CSng|CStr|Date|DateAdd|DateDiff|DatePart|DateSerial|DateValue|Day|Derived|Math|Escape|Eval|Exists|Exp|Filter|FormatCurrency|FormatDateTime|FormatNumber|FormatPercent|GetLocale|GetObject|GetRef|Hour|InputBox|InStrRev|Int|Fix|IsArray|IsDate|IsEmpty|IsNull|IsNumeric|IsObject|Item|Items|Join|Keys|LBound|LoadPicture|Log|Trim|Maths|Minute|Month|MonthName|MsgBox|Now|Oct|Remove|RemoveAll|Replace|RGB|Rnd|Round|ScriptEngine|ScriptEngineBuildVersion|ScriptEngineMajorVersion|ScriptEngineMinorVersion|Second|SetLocale|Sgn|Sin|Split|Sqr|StrComp|StrReverse|Tan|Time|Timer|TimeSerial|TimeValue|TypeName|UBound|Unescape|VarType|Weekday|WeekdayName|Year',
      'support.type.vb.asp': 'vbtrue|vbfalse|vbcr|vbcrlf|vbformfeed|vblf|vbnewline|vbnullchar|vbnullstring|int32|vbtab|vbverticaltab|vbbinarycompare|vbtextcomparevbsunday|vbmonday|vbtuesday|vbwednesday|vbthursday|vbfriday|vbsaturday|vbusesystemdayofweek|vbfirstjan1|vbfirstfourdays|vbfirstfullweek|vbgeneraldate|vblongdate|vbshortdate|vblongtime|vbshorttime|vbobjecterror|vbEmpty|vbNull|vbInteger|vbLong|vbSingle|vbDouble|vbCurrency|vbDate|vbString|vbObject|vbError|vbBoolean|vbVariant|vbDataObject|vbDecimal|vbByte|vbArray',
    },'identifier',true);
    this.$rules = {
      start: [
        { token: ['meta.ending-space'], regex: '$' },
        { token: ['prompt'], regex: '-->'},
        {
          token: [
            'text',
            'storage.type.function.asp',
            'text',
            'entity.name.function.asp',
            'text',
            'punctuation.definition.parameters.asp',
            'variable.parameter.function.asp',
            'punctuation.definition.parameters.asp',
          ],
          regex:
            '^(\\s*)(Function|Sub)(\\s+)([a-zA-Z_]\\w*)(\\s*)(\\()([^)]*)(\\))',
        },
        {
          token: 'punctuation.definition.comment.asp',
          regex: "'$|REM(?=\\s|$)$",
          next: 'start',
          caseInsensitive: !0,
        },
        {
          token: 'punctuation.definition.comment.asp',
          regex: "'|REM(?=\\s|$)",
          next: 'comment',
          caseInsensitive: !0,
        },
        {
          token: 'storage.type.asp',
          regex: 'On Error Resume Next|On Error GoTo',
          caseInsensitive: !0,
        },
        {
          token: 'punctuation.definition.string.begin.asp',
          regex: '"',
          next: 'string',
        },
        {
          token: ['punctuation.definition.variable.asp'],
          regex:
            '(\\$)[a-zA-Z_x7f-xff][a-zA-Z0-9_x7f-xff]*?\\b\\s*',
        },
        { regex: '(?:\\w|\\$)+', token: e },
        {
          token: ['entity.name.function.asp'],
          regex:
            '(?:(\\b[a-zA-Z_x7f-xff][a-zA-Z0-9_x7f-xff]*?\\b)(?=\\(\\)?))',
        },
        {
          token: ['keyword.operator.asp'],
          regex: '\\-|\\+|\\*\\/|\\>|\\<|\\=|\\&',
        },
      ],
      comment: [
        {
          token: 'comment.line.apostrophe.asp',
          regex: '$|(?=(?:%>))',
          next: 'start',
        },
        { defaultToken: 'comment.line.apostrophe.asp' },
      ],
      string: [
        {
          token: 'string.quoted.double.asp',
          regex: '$|"',
          next: 'start',
        },
        { defaultToken: 'string.quoted.double.asp' },
      ],
    };
  };
  r.inherits(s, i), (t.VBScriptHighlightRules = s);
});
define(
    'ace/mode/mcbasic',
    (e, t, n) => {
      'use strict';
      const r = e('../lib/oop'),
        myFoldMode = e("./folding/mcbasic").FoldMode,
        workerClient = e("../worker/worker_client").WorkerClient,
        i = e('./text').Mode,
        s = e('./mcbasic_highlight_rules').VBScriptHighlightRules,
        o = function() {
          this.HighlightRules = s;
          this.foldingRules = new myFoldMode();
        };
      r.inherits(o, i),
        function() {
          (this.createWorker = function(session) {
            const worker = new workerClient(["ace"], "ace/mode/mcbasic_worker", "Worker");
            worker.attachToDocument(session.getDocument());
    
            worker.on("annotate", function(e) {
                session.setAnnotations(e.data);
                session.bgTokenizer.start(0);
            });
    
            worker.on("terminate", function() {
                session.clearAnnotations();
            });

            worker.on("functions", function(e) {
              session.functions = e.data;
            });

            worker.on("blocks", function(e) {
              session.blocks = e.data;
            });

            worker.on("subs", function(e) {
              session.subs = e.data;
            });
    
            return worker;
        }),
          (this.lineCommentStart = ["'", 'REM']),
          (this.$id = 'ace/mode/mcbasic');
        }.call(o.prototype),
        (t.Mode = o);
    }
  );