<div class="mat-typography">
	<div class="title mat-elevation-z1"><mat-icon>add</mat-icon>&nbsp;&nbsp;{{ 'variables.new' | translate }}</div>
	<div class="name-wrapper">
		<mat-form-field class="variableName">
			<input matInput placeholder="{{ 'variables.name' | translate }}" [formControl]="name" maxlength="32" virtualKeyboard ktype="text" />
			<mat-error *ngIf="name.invalid">{{ 'error.invalid_var_name' | translate }}</mat-error>
		</mat-form-field>
		<mat-form-field *ngIf="!data.domainIsFrame">
			<mat-select
				placeholder="{{ 'variables.type' | translate }}"
				[(ngModel)]="varType"
				(selectionChange)="onTypeChange()"
				[disabled]="busy"
			>
				<mat-option *ngIf="isHotOption(0) && data.isRobotType" value="JOINT">{{ 'joint' | translate }}</mat-option>
				<mat-option *ngIf="isHotOption(1) && data.isRobotType" value="LOCATION">{{
					'location' | translate
				}}</mat-option>
				<mat-option *ngIf="isHotOption(2)" value="LONG">{{ 'long' | translate }}</mat-option>
				<mat-option *ngIf="isHotOption(3)" value="DOUBLE">{{ 'double' | translate }}</mat-option>
				<mat-option *ngIf="isHotOption(4)" value="STRING">{{ 'string' | translate }}</mat-option>
			</mat-select>
		</mat-form-field>
		<mat-checkbox *ngIf="canUseArray" color="primary" [(ngModel)]="isArray" [disabled]="busy">{{ 'arr' | translate }}</mat-checkbox>
		<mat-form-field *ngIf="isArray && varType === 'STRING'" style="margin-top: 8px;">
			<mat-select placeholder="{{ 'dimension' | translate }}" [(ngModel)]="dimension"  [disabled]="busy">
					<mat-option [value]=1>1</mat-option>
					<mat-option [value]=2>2</mat-option>
			</mat-select>
		</mat-form-field>

		<!-- <mat-form-field *ngIf="canUseArray && isArray && dimension === 1" style="margin-top: 8px;">
			<input matInput
				placeholder="{{ 'arr_size' | translate }}"
				[(ngModel)]="arrSize" virtualKeyboard
				ktype="numeric_int_pos"
				[formControl]="validationControls[dataParameterReference.OneArraySize]"
				[errorStateMatcher]="errorMatcher"
				/>
			<mat-error>
				{{ getErrors(validationControls[dataParameterReference.OneArraySize]) }}
			</mat-error>
        </mat-form-field> -->
        <custom-key-board type="int"  [min]="1"  [required]="true" placeHolder="{{ 'arr_size' | translate }}" [isNgIf]="canUseArray && isArray && dimension === 1" [isPositiveNum]=true [(value)]="arrSize"></custom-key-board>

		<!-- <mat-form-field *ngIf="canUseArray && isArray && dimension === 2" style="margin-top: 8px;">
			<input matInput
				placeholder="{{ 'one_dimension_size' | translate }}"
				[(ngModel)]="arrSize" virtualKeyboard
				ktype="numeric_int_pos"
				[formControl]="validationControls[dataParameterReference.OneArraySize]"
				[errorStateMatcher]="errorMatcher"
				/>
			<mat-error>
				{{ getErrors(validationControls[dataParameterReference.OneArraySize]) }}
			</mat-error>
        </mat-form-field> -->
        <div *ngIf="canUseArray && isArray && dimension === 2">
            <custom-key-board type="int"
                placeHolder="{{ 'one_dimension_size' | translate }}"
                [isPositiveNum]=true
                [min]="1"
                [required]="true"
                [(value)]="arrSize"
                [requiredErrMsg]="getErrors(validationControls[dataParameterReference.OneArraySize])"
            ></custom-key-board>
        </div>

		<!-- <mat-form-field *ngIf="isArray && varType === 'STRING' && dimension === 2"
		                style="margin-top: 8px;"
		>
			<input matInput
				placeholder="{{ 'two_dimension_size' | translate }}"
				[(ngModel)]="arrSecondSize" virtualKeyboard
				ktype="numeric_int_pos"
				[formControl]="validationControls[dataParameterReference.TwoArraySize]"
				[disabled]="busy"
				[errorStateMatcher]="errorMatcher"/>
			<mat-error>
				{{ getErrors(validationControls[dataParameterReference.TwoArraySize]) }}
			</mat-error>
        </mat-form-field>  -->
        <custom-key-board [disabled]="busy" type="int" placeHolder="{{ 'two_dimension_size' | translate }}" [isNgIf]="isArray && varType === 'STRING' && dimension === 2" [isPositiveNum]=true [(value)]="arrSecondSize"></custom-key-board>

		<div *ngIf="!isArray && varType" style="margin-top: 8px;">
			<div class="label">{{ 'values' | translate }}</div>
			<div class="value-container">
				<div *ngIf="varType === 'JOINT'" class="values">
					<!-- <mat-form-field *ngFor="let joint of data.robotCoordinateType.legends; let i = index" floatLabel="never">
						<span matPrefix style="font-weight: bold;">J{{ i + 1 }}:&nbsp;&nbsp;</span>
						<input matInput [placeholder]="'J' + (i + 1)" [(ngModel)]="this.values[i]" virtualKeyboard ktype="numeric"  [disabled]="busy" />
                    </mat-form-field> -->
                    <span style="display: flex;">
                        <custom-key-board type="float" [prefix]="'J'+(i+1)+':&nbsp;&nbsp;'" style="width: 80px;"
                            [(value)]="this.values[i]" [disabled]="busy"
                            *ngFor="let joint of data.robotCoordinateType.legends; let i = index"
                        ></custom-key-board>
                    </span>
				</div>
				<div *ngIf="varType === 'LOCATION'" class="values">
                    <div *ngFor="let legend of data.robotCoordinateType.all; let i = index" >
                        <div *ngIf="i < data.robotCoordinateType.legends.length">
                            <custom-key-board type="float" style="width: 25%;float: left;" [disabled]="busy" prefix="{{ legend }}:&nbsp;&nbsp;" [(value)]="this.values[i]"></custom-key-board>
                        </div>
                        <div *ngIf="i >= data.robotCoordinateType.legends.length">
                            <mat-form-field floatLabel="never" [class.flag-select]="i >= data.robotCoordinateType.legends.length">
                                <span matPrefix style="font-weight: bold;" *ngIf="i >= data.robotCoordinateType.legends.length">{{ legend }}:&nbsp;&nbsp;</span>
                                <!-- <input
                                    *ngIf="i < data.robotCoordinateType.legends.length"
                                    matInput
                                    [placeholder]="legend"
                                    [(ngModel)]="this.values[i]"
                                    virtualKeyboard
                                    [disabled]="busy"
                                    ktype="numeric"
                                    style="display: none;border:none"
                                /> -->
                                <mat-select *ngIf="i >= data.robotCoordinateType.legends.length" [(ngModel)]="this.values[i]"  [disabled]="busy">
                                    <div *ngIf="data.robotCoordinateType.flags[i - data.robotCoordinateType.legends.length] === 'Arm'">
                                        <mat-option value="0">AUTO</mat-option>
                                        <mat-option value="1">LEFTY</mat-option>
                                        <mat-option value="2">RIGHTY</mat-option>
                                    </div>
                                    <div *ngIf="data.robotCoordinateType.flags[i - data.robotCoordinateType.legends.length] === 'Elbow'">
                                        <mat-option value="0">AUTO</mat-option>
                                        <mat-option value="1">BELOW</mat-option>
                                        <mat-option value="2">ABOVE</mat-option>
                                    </div>
                                    <div *ngIf="data.robotCoordinateType.flags[i - data.robotCoordinateType.legends.length] === 'Wrist'">
                                        <mat-option value="0">AUTO</mat-option>
                                        <mat-option value="1">NOFLIP</mat-option>
                                        <mat-option value="2">FLIP</mat-option>
                                    </div>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </div>
				</div>
				<div *ngIf="varType && varType !== 'LOCATION' && varType !== 'JOINT'" class="values">
					<mat-form-field floatLabel="never" style="width: inherit;" *ngIf="varType === 'STRING'">
						<span matPrefix style="font-weight: bold;">{{ 'value' | translate }}:&nbsp;&nbsp;</span>
						<!-- <input
							*ngIf="varType === 'LONG'"
							matInput
							[placeholder]="Value"
							[(ngModel)]="this.values[0]"
							virtualKeyboard
							[disabled]="busy"
							ktype="numeric_int"
                        /> -->
						<!-- <input
							*ngIf="varType === 'DOUBLE'"
							matInput
							[placeholder]="Value"
							[(ngModel)]="this.values[0]"
							virtualKeyboard
							[disabled]="busy"
							ktype="numeric"
                        /> -->
						<textarea
							matInput
							[placeholder]="Value"
							[(ngModel)]="this.values[0]"
							virtualKeyboard
							ktype="text"
							cdkTextareaAutosize
							#autosize="cdkTextareaAutosize"
							maxlength="80"
							[disabled]="busy"
							cdkAutosizeMinRows="1"
						></textarea>
                    </mat-form-field>
                    <custom-key-board  prefix="{{ 'value' | translate }}:&nbsp;&nbsp;" type="int" [isNgIf]="varType === 'LONG'" [placeHolder]="Value" [(value)]="this.values[0]" [disabled]="busy"></custom-key-board>
                    <custom-key-board  prefix="{{ 'value' | translate }}:&nbsp;&nbsp;" type="float" [isNgIf]="varType === 'DOUBLE'" [placeHolder]="Value" [(value)]="this.values[0]" [disabled]="busy"></custom-key-board>
				</div>
				<button
        *ngIf="varType === 'JOINT' || varType === 'LOCATION'"
        mat-raised-button
        color="primary"
				(click)="getCurrent()"
				[disabled]="busy"
        style="align-self: flex-start;">
					{{'variables.get_current'|translate}}
				</button>
			</div>
		</div>
	</div>
	<div class="actions">
		<button mat-button mat-dialog-close [disabled]="busy">
			{{ 'button.cancel' | translate }}
		</button>
		<button mat-raised-button color="primary" [disabled]="name.invalid || !varType || busy" [clickOnce]="add" [clickOnceContext]="this" class="btnCreate">
			<div *ngIf="!busy">{{ 'variables.btn_create' | translate }}</div>
			<div *ngIf="busy"><mat-spinner color="primary" diameter="24" style="margin: 8px;"></mat-spinner></div>
		</button>
	</div>
</div>
