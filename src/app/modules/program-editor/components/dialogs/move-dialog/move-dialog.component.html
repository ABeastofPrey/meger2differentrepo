<form class="mat-typography" [formGroup]="ctrl" (ngSubmit)="insert()">
	<div class="wrapper">
		<div class="title">
			{{ (data.moveS ? 'projectCommands.move.title_moves' : 'projectCommands.move.title_move') | translate }}
		</div>
		<div class="content">
			<mat-form-field>
				<mat-select
					placeholder="{{ 'projectCommands.move.move' | translate }}"
					formControlName="location"
					(selectionChange)="resetIndex()"
				>
					<mat-optgroup label="{{ 'joints' | translate }}" *ngIf="this.dataService.joints.length > 0"
						><mat-option *ngFor="let data of this.dataService.joints" [value]="data"
							>{{ data.name }}<span *ngIf="data.isArr">[...]</span></mat-option
						></mat-optgroup
					>
					<mat-optgroup label="{{ 'locations' | translate }}" *ngIf="this.dataService.locations.length > 0"
						><mat-option *ngFor="let data of this.dataService.locations" [value]="data"
							>{{ data.name }}<span *ngIf="data.isArr">[...]</span></mat-option
						></mat-optgroup
					>
					<mat-option class="create-point-option" (click)="createPoint()">
						+ {{ 'projectCommands.createVar' | translate }}
					</mat-option>
				</mat-select>
			</mat-form-field>
			<mat-form-field *ngIf="location && location.isArr && !rangeMode">
				<mat-select placeholder="{{ 'index' | translate }}" formControlName="locationIndex">
					<mat-option *ngFor="let data of location.value; let i = index" [value]="i + 1">{{ i + 1 }}</mat-option>
				</mat-select>
			</mat-form-field>
			<div class="rangeSelector" *ngIf="rangeMode">
				<mat-form-field>
					<mat-select placeholder="{{ 'projectCommands.move.index_from' | translate }}" formControlName="indexFrom">
						<mat-option *ngFor="let data of location.value; let i = index" [value]="i + 1">{{ i + 1 }}</mat-option>
					</mat-select>
				</mat-form-field>
				<mat-form-field>
					<mat-select placeholder="{{ 'projectCommands.move.index_to' | translate }}" formControlName="indexTo">
						<mat-option *ngFor="let data of location.value; let i = index" [value]="i + 1">{{ i + 1 }}</mat-option>
					</mat-select>
          <mat-error *ngIf="ctrl.hasError('invalidRange')">
            {{ 'form_validation.range' | translate }}
          </mat-error>
				</mat-form-field>
			</div>
			<mat-slide-toggle
				formControlName="rangeMode"
				style="margin-bottom: 8px; margin-right: 16px;"
				color="primary"
				*ngIf="location && location.isArr"
				>{{ 'projectCommands.move.range' | translate }}</mat-slide-toggle
			>
			<mat-slide-toggle formControlName="advancedMode" style="margin-bottom: 8px;" color="primary">{{
				'advanced' | translate
			}}</mat-slide-toggle>
			<div *ngIf="advancedMode">
				<mat-form-field>
					<mat-select placeholder="{{ 'motion_element' | translate }}" formControlName="motionElement">
						<mat-option *ngFor="let e of dataService.robots" [value]="e + ' '">{{ e }}</mat-option>
					</mat-select>
				</mat-form-field>
				<mat-form-field>
					<input
						matInput
						[placeholder]="data.moveS ? 'VTran [mm/s]' : 'VScale [%]'"
						formControlName="vscale"
						virtualKeyboard
						ktype="numeric"
					/>
					<mat-error *ngIf="ctrl.get('vscale').invalid">
            {{ 'form_validation.percent' | translate }}
          </mat-error>
				</mat-form-field>
				<mat-form-field>
					<input 
        matInput
        placeholder="{{ 'projectCommands.jump.blendingPh' | translate }}"
        
        formControlName="blendingPh"
        virtualKeyboard ktype="numeric" />
					<span matSuffix>%</span>
          <mat-error *ngIf="blendingPh.invalid">
            {{ 'form_validation.percent' | translate }}
          </mat-error>
				</mat-form-field>
				<mat-form-field>
					<mat-select placeholder="{{ 'projectSettings.position_trigger.title' | translate }}" [(ngModel)]="pts" multiple [ngModelOptions]="{standalone: true}">
						<mat-option *ngFor="let pt of ptList" [value]="pt">{{ pt }}</mat-option>
					</mat-select>
				</mat-form-field>
			</div>
		</div>
	</div>
	<div class="actions">
		<button mat-button matDialogClose>
			{{ 'button.cancel' | translate }}
		</button>
		<button
			mat-button
			color="primary"
    type="submit"
			[disabled]="ctrl.invalid"
		>
			{{ (!this.withParams ? 'button.insert' : 'button.edit') | translate }}
		</button>
	</div>
</form>
