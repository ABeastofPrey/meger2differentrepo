<h2 mat-dialog-title class="mat-toolbar mat-primary mat-elevation-z3">
  <div
    class="mat-inner-title"
    title="{{
      ('pluginInstall.title' | translate) + ' - ' + stepInfo.title | translate
    }}"
  >
    {{
      ('pluginInstall.title' | translate) +
        ' - ' +
        (stepInfo?.title | translate)
    }}
  </div>
</h2>
<mat-dialog-content>
  <div class="errorTips">
    <mat-spinner *ngIf="isBusy"></mat-spinner>
    <ng-container *ngIf="errorTips">
      <mat-icon aria-hidden="false" color="warn">info</mat-icon>
      <span>{{ errorTips | translate }}</span>
    </ng-container>
  </div>
  <!-- first step history version check -->
  <ng-container *ngIf="stepInfo?.id === pluginStepIds?.HistoryCheck">
    <ng-container *ngIf="versionStateInfo?.state === versionStates.NotInstall">
      <mat-icon aria-hidden="false" color="primary"> check_circle</mat-icon>
      <span>{{
        'pluginInstall.historyCheck.notInstallTips'
          | translate: { name: versionStateInfo?.name }
      }}</span>
    </ng-container>
    <ng-container *ngIf="versionStateInfo?.state === versionStates.SameVersion">
      <mat-icon aria-hidden="false" color="accent">info</mat-icon>
      <span>{{
        'pluginInstall.historyCheck.sameVersionTips'
          | translate
            : {
                name: versionStateInfo?.name,
                version: versionStateInfo?.install
              }
      }}</span>
    </ng-container>
    <ng-container *ngIf="versionStateInfo?.state === versionStates.DiffVersion">
      <mat-icon aria-hidden="false" color="accent">info</mat-icon>
      <span>{{
        'pluginInstall.historyCheck.diffVersionTips'
          | translate
            : {
                name: versionStateInfo?.name,
                version: versionStateInfo?.install,
                previousVersion: versionStateInfo?.version
              }
      }}</span>
    </ng-container>
  </ng-container>

  <!-- second step  DependenciesCheck-->
  <div
    *ngIf="stepInfo?.id === pluginStepIds?.DependenciesCheck"
    class="dependenciesCheck"
  >
    <div
      *ngIf="dependenciesCheckInfo?.state === dependenciesCheckStates.satisfied"
      class="dependenciesSuccess"
    >
      <mat-icon aria-hidden="false" color="primary"> check_circle</mat-icon>
      <span>{{
        'pluginInstall.dependenciesCheck.canInstallTips'
          | translate
            : {
                name: versionStateInfo?.name,
                version: versionStateInfo?.install
              }
      }}</span>
    </div>
    <ng-container
      *ngIf="
        dependenciesCheckInfo?.state === dependenciesCheckStates.unSatisfied
      "
    >
      <div class="dependenciesCheckFail">
        <mat-icon aria-hidden="false" color="warn">cancel</mat-icon>
        <span>{{
          'pluginInstall.dependenciesCheck.unSatisfiedTips'
            | translate
              : {
                  name: versionStateInfo?.name,
                  version: versionStateInfo?.install
                }
        }}</span>
      </div>
      <div class="table-container">
        <table
          mat-table
          [dataSource]="dependenciesCheckInfo?.dependencies"
          class="mat-elevation-z8"
        >
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef>
              {{
                'pluginInstall.dependenciesCheck.dependencies.name' | translate
              }}
            </th>
            <td mat-cell *matCellDef="let element">{{ element.name }}</td>
          </ng-container>
          <ng-container matColumnDef="require">
            <th mat-header-cell *matHeaderCellDef>
              {{
                'pluginInstall.dependenciesCheck.dependencies.require'
                  | translate
              }}
            </th>
            <td mat-cell *matCellDef="let element">{{ element.require }}</td>
          </ng-container>

          <ng-container matColumnDef="act">
            <th mat-header-cell *matHeaderCellDef>
              {{
                'pluginInstall.dependenciesCheck.dependencies.state' | translate
              }}
            </th>
            <!-- ? ('pluginInstall.dependenciesCheck.dependencies.notInstall': translate): () -->
            <td mat-cell *matCellDef="let element">
              {{
                !element.act
                  ? ('pluginInstall.dependenciesCheck.dependencies.notInstall'
                    | translate)
                  : ('pluginInstall.dependenciesCheck.dependencies.installed'
                    | translate: { version: element.act })
              }}
            </td>
          </ng-container>

          <tr
            mat-header-row
            *matHeaderRowDef="displayedColumns; sticky: true"
          ></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
      </div>
    </ng-container>
  </div>
  <!-- third step duplicate check -->
  <ng-container *ngIf="stepInfo?.id === pluginStepIds?.DuplicateCheck">
    <ng-container
      *ngIf="duplicationInfo?.state === duplicationStates.NoDuplicateFile"
    >
      <mat-icon aria-hidden="false" color="primary"> check_circle</mat-icon>
      <span>{{
        'pluginInstall.duplicationCheck.canInstallTips' | translate
      }}</span>
    </ng-container>
    <ng-container
      *ngIf="duplicationInfo?.state === duplicationStates.HasDuplicateFile"
    >
      <mat-icon aria-hidden="false" color="primary">warning</mat-icon>
      <span>{{
        'pluginInstall.duplicationCheck.hasDuplicateFile'
          | translate: { files: duplicationInfo.filesStr }
      }}</span>
    </ng-container>
  </ng-container>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button
    class="cancelBtn"
    color="primary"
    mat-button
    [disabled]="stepInfo?.cancelBtnDisabled"
    (click)="onCancel()"
  >
    {{ 'button.cancel' | translate }}
  </button>
  <button
    class="nextBtn"
    mat-raised-button
    color="primary"
    mat-button
    cdkFocusInitial
    [disabled]="stepInfo?.disabled"
    (click)="onNext()"
  >
    {{ stepInfo?.btnName | translate }}
  </button>
</mat-dialog-actions>
